<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <!-- xml中部分重复的配置或者是动态的变量可以通过其他文件引入，比如变量问题,该文件可以引入变量解决undefined -->
    <include resource="org/springframework/boot/logging/logback/base.xml"/>
    <!-- 日志文件输出格式,在控制台输出 -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%date %-5level [v:${yes.log.version}] [h:${yes.server.localHost}]
                [m:${simplelii.env.module}] [reqId:%X{yes.req.requestId}] [%thread] %logger{36} [L:%line] -
                %msg%n
                %date{yyyy-MM-dd HH:mm:ss}[${logback.appName}:%thread]%-5level %logger [%file:%line]:%msg%n
            </pattern>
        </encoder>
    </appender>
    <!-- 写入文件配置 -->
    <appender name="ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>
            ${yes.server.logWorkDir}/${simplelii.env.module}/${simplelii.env.module}.log
        </file>
        <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
            <fileNamePattern>
                ${yes.server.logWorkDir}/${simplelii.env.module}/${simplelii.env.module}-%d{yyyy-MM-dd}.%i.log
            </fileNamePattern>
            <maxFileSize>5MB</maxFileSize>
            <maxHistory>30</maxHistory>
            <totalSizeCap>10GB</totalSizeCap>
        </rollingPolicy>
        <encoder>
            <pattern>%date %-5level [v:${yes.log.version}] [h:${yes.server.localHost}]
                [m:${simplelii.env.module}] [reqId:%X{yes.req.requestId}] [%thread] %logger{36} [L:%line] -
                %msg%n
            </pattern>
        </encoder>
    </appender>

    <!-- project default level -->
    <logger name="com.perfect.mall.app.dao.mapper" level="DEBUG"/>
    <logger name="com.dtyunxi.yundt" level="DEBUG"/>
    <logger name="org" level="INFO"/>
    <!--log4jdbc -->
    <logger name="jdbc.sqltiming" level="debug"/>
    <logger name="com.ibatis" level="DEBUG"/>
    <logger name="com.ibatis.common.jdbc.SimpleDataSource" level="debug"/>
    <logger name="com.ibatis.common.jdbc.ScriptRunner" level="debug"/>
    <logger name="com.ibatis.sqlmap.engine.impl.SqlMapClientDelegate" level="debug"/>
    <logger name="java.sql.Connection" level="DEBUG"/>
    <logger name="java.sql.Statement" level="DEBUG"/>
    <logger name="java.sql.PreparedStatement" level="DEBUG"/>
    <!-- 标签logger 默认的日志 -->
    <root level="${simplelii.env.logger.level}">
        <appender-ref ref="ROLLING"/>
    </root>

    <!--日志异步到数据库 -->
    <!--<appender name="DB" class="ch.qos.logback.classic.db.DBAppender">-->
        <!--&lt;!&ndash;日志异步到数据库 &ndash;&gt;-->
        <!--<connectionSource class="ch.qos.logback.core.db.DriverManagerConnectionSource">-->
            <!--&lt;!&ndash;连接池 druid 有bug，使用c3p0&ndash;&gt;-->
            <!--<dataSource class="com.alibaba.druid.pool.DruidDataSource">-->
                <!--<driverClass>com.mysql.jdbc.Driver</driverClass>-->
                <!--<url>${spring.datasource.url}</url>-->
                <!--<user>${spring.datasource.username}</user>-->
                <!--<password>${spring.datasource.password}</password>-->
            <!--<sqlDialect class="ch.qos.logback.core.db.dialect.MySQLDialect" />-->
            <!--</dataSource>-->
        <!--</connectionSource>-->
        <!--<flter class="ch.qos.logback.classic.filter.ThresholdFilter">-->
            <!--<level>REEOR</level>-->
        <!--</flter>-->
    <!--</appender>-->
</configuration>
